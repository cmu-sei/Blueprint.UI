<!--
Copyright 2022 Carnegie Mellon University. All Rights Reserved.
Released under a MIT (SEI)-style license, please see LICENSE.md in the
project root for license information or contact permission@sei.cmu.edu for full terms.
-->
<div *ngIf="msel" class="scrolling-region">
  <div class="mat-elevation-z2 section-container">
    <div class="section-content">
      <mat-expansion-panel
        *ngFor="let mselTeam of mselTeamList; trackBy: trackByFn"
      >
        <mat-expansion-panel-header
          (click)="$event.stopPropagation();"
        >
          <button
            mat-icon-button
            (click)="removeTeamFromMsel(mselTeam.id); $event.stopPropagation();"
            title="Remove team from MSEL"
            *ngIf="isContentDeveloper || msel.hasRole(loggedInUserId, null).owner"
          >
            <mat-icon class="mdi-24px self-center" fontIcon="mdi-minus-circle-outline"></mat-icon>
          </button>
          <span class="center-self">{{ getTeam(mselTeam.teamId).shortName }} - {{ getTeam(mselTeam.teamId).name }}</span>
        </mat-expansion-panel-header>
        <div class="team-detail" *ngFor="let user of getMselTeamUsers(mselTeam.teamId)">
          <div class="user-name four-cell">{{ user.name }}</div>
          <div class="msel-role one-cell" *ngFor="let mselRole of mselRoles">
            <mat-checkbox
              [checked]="hasMselRole(user.id, mselRole)"
              (change)="toggleMselRole(user.id, mselRole, $event.checked)"
              (click)="$event.stopPropagation();"
              style="margin-right: 20px;"
              [disabled]="!isContentDeveloper && !msel.hasRole(loggedInUserId, null).owner"
              >{{ mselRole }}</mat-checkbox
            >
          </div>
        </div>
        <div class="team-detail" *ngIf="getMselTeamUsers(mselTeam.teamId).length === 0">This team has no users.</div>
        <div class="team-detail" *ngIf="msel.useCite">
          <mat-form-field class="button-margins half-width">
            <mat-label *ngIf="mselTeam.citeTeamTypeId">CITE Team Type</mat-label>
            <mat-label *ngIf="!mselTeam.citeTeamTypeId">Not used by CITE</mat-label>
            <mat-select
              [value]="mselTeam.citeTeamTypeId"
              (selectionChange)="setTeamType(mselTeam, $event.value)"
            >
              <mat-option [value]="''">Not used by CITE</mat-option>
              <mat-option *ngFor="let teamType of teamTypeList" [value]="teamType.id">
                {{ teamType.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </mat-expansion-panel>
    </div>
  </div>
  <div class="mat-elevation-z2 section-container" *ngIf="isContentDeveloper || msel.hasRole(loggedInUserId, null).owner">
    <div class="section-content">
      <mat-expansion-panel>
        <mat-expansion-panel-header
          (click)="$event.stopPropagation();"
        >
          Add a Team
          </mat-expansion-panel-header>
          <div class="other-teams-div" *ngFor="let team of getTeamList()">
            <button
              mat-icon-button
              (click)="addTeamToMsel(team.id); $event.stopPropagation();"
              title="Add team to MSEL"
            >
              <mat-icon class="mdi-24px self-center" fontIcon="mdi-plus-circle-outline"></mat-icon>
            </button>
            {{ team.shortName }} - {{ team.name }}
          </div>
      </mat-expansion-panel>
    </div>
  </div>
</div>
